<!-- ... (HEAD stays the same except the added styles below) -->
<style>
  /* Add near-3D look using shadows */
  .shooter {
    box-shadow: 0 6px 10px rgba(0,0,0,0.4);
    background: radial-gradient(crimson, darkred);
  }
  .bullet {
    box-shadow: 0 0 10px limegreen;
  }
  .choice {
    background: linear-gradient(to bottom right, #ff6666, #cc0000);
    box-shadow: 2px 4px 8px rgba(0,0,0,0.3);
  }

  #questionDisplay {
    text-align: center;
    font-size: 1.3rem;
    margin: 5px 0;
    font-weight: bold;
  }
</style>
</head>
<body>
  <h1>ðŸŽ¯ Algebra Shooter</h1>
  <div class="game-info">
    Score: <span id="score">0</span> |
    Lives: <span id="lives">3</span> |
    Time: <span id="time">20</span>
  </div>
  <div id="questionDisplay">Solve: </div> <!-- NEW -->
  <div class="game-box" id="gameBox">
    <div class="shooter" id="shooter"></div>
    <div class="bullet" id="bullet"></div>
  </div>
  <div id="gameOver"></div>

  <script>
    const shooter = document.getElementById('shooter');
    const bullet = document.getElementById('bullet');
    const gameBox = document.getElementById('gameBox');
    const gameOverDisplay = document.getElementById('gameOver');
    const scoreDisplay = document.getElementById('score');
    const livesDisplay = document.getElementById('lives');
    const timeDisplay = document.getElementById('time');
    const questionDisplay = document.getElementById('questionDisplay'); // NEW

    let keys = {};
    let bulletInterval;
    let answerElements = [];
    let correctAnswer;
    let score = 0;
    let lives = 3;
    let gameActive = true;
    let timer = 20; // NEW
    let timerInterval; // NEW

    const getRandom = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;

    function generateQuestion() {
      let a = getRandom(1, 10);
      let b = getRandom(1, 10);
      correctAnswer = a;
      questionDisplay.textContent = `Solve: x + ${b} = ${a + b}`; // NEW
      return {
        correct: a
      };
    }

    function startTimer() {
      clearInterval(timerInterval);
      timer = 20;
      timeDisplay.textContent = timer;
      timerInterval = setInterval(() => {
        if (!gameActive) return clearInterval(timerInterval);
        timer--;
        timeDisplay.textContent = timer;
        if (timer <= 0) {
          clearInterval(timerInterval);
          lives--;
          livesDisplay.textContent = lives;
          gameOverDisplay.textContent = "â³ Time's up!";
          if (lives <= 0) return endGame();
          setTimeout(() => {
            gameOverDisplay.textContent = "";
            renderQuestion();
          }, 1000);
        }
      }, 1000);
    }

    function renderQuestion() {
      if (!gameActive) return;
      answerElements.forEach(el => el.remove());
      const { correct } = generateQuestion();
      correctAnswer = correct;

      const used = new Set([correct]);
      for (let i = 0; i < 4; i++) {
        let val;
        do {
          val = i === 0 ? correct : correct + getRandom(-5, 5);
        } while (used.has(val));
        used.add(val);

        const choice = document.createElement('div');
        choice.className = 'choice';
        choice.textContent = val;
        choice.dataset.answer = val;
        choice.style.top = `${getRandom(50, gameBox.clientHeight - 150)}px`;
        choice.style.left = `${getRandom(50, gameBox.clientWidth - 100)}px`;
        gameBox.appendChild(choice);
        answerElements.push(choice);
      }
      startTimer(); // NEW
    }

    function shootBullet() {
      if (!gameActive) return;
      bullet.style.display = 'block';
      bullet.style.left = `${shooter.offsetLeft + shooter.offsetWidth/2 - 2.5}px`;
      bullet.style.top = `${shooter.offsetTop}px`;

      clearInterval(bulletInterval);
      bulletInterval = setInterval(() => {
        bullet.style.top = `${bullet.offsetTop - 10}px`;
        if (bullet.offsetTop <= 0) {
          bullet.style.display = 'none';
          clearInterval(bulletInterval);
        }

        answerElements.forEach(target => {
          const b = bullet.getBoundingClientRect();
          const t = target.getBoundingClientRect();

          if (b.bottom >= t.top && b.top <= t.bottom &&
              b.right >= t.left && b.left <= t.right) {
            clearInterval(bulletInterval);
            bullet.style.display = 'none';
            const isCorrect = parseInt(target.dataset.answer) === correctAnswer;
            clearInterval(timerInterval); // NEW

            if (isCorrect) {
              score++;
              gameOverDisplay.style.color = 'green';
              gameOverDisplay.textContent = "âœ” Correct!";
            } else {
              lives--;
              gameOverDisplay.style.color = 'red';
              gameOverDisplay.textContent = "âœ˜ Wrong!";
              if (lives <= 0) return endGame();
            }

            scoreDisplay.textContent = score;
            livesDisplay.textContent = lives;
            setTimeout(() => {
              gameOverDisplay.textContent = "";
              renderQuestion();
            }, 800);
          }
        });
      }, 30);
    }

    function endGame() {
      gameActive = false;
      clearInterval(timerInterval); // NEW
      gameOverDisplay.style.color = 'black';
      gameOverDisplay.textContent = `ðŸ’€ Game Over! Final Score: ${score}`;
      timeDisplay.textContent = "--"; // NEW
    }

    function moveShooter() {
      if (!gameActive) return;
      const speed = 6;
      const left = shooter.offsetLeft;
      if (keys["ArrowLeft"] && left > 0) {
        shooter.style.left = `${left - speed}px`;
      }
      if (keys["ArrowRight"] && left + shooter.clientWidth < gameBox.clientWidth) {
        shooter.style.left = `${left + speed}px`;
      }
    }

    function gameLoop() {
      moveShooter();
      requestAnimationFrame(gameLoop);
    }

    document.addEventListener("keydown", e => {
      keys[e.key] = true;
      if ((e.key === " " || e.key === "Enter") && gameActive) shootBullet();
    });

    document.addEventListener("keyup", e => keys[e.key] = false);

    function initGame() {
      shooter.style.left = `${gameBox.clientWidth / 2 - shooter.clientWidth / 2}px`;
      renderQuestion();
      gameLoop();
    }

    window.onload = initGame;
  </script>
</body>
</html>
