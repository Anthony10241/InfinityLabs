<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>3D Algebra Shooter - InfinityLabs</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&family=Lora:wght@700&display=swap" rel="stylesheet">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      height: 100%;
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(#e0e0e0, #c0c0c0);
      color: #800000;
    }

    h1 {
      font-family: 'Lora', serif;
      font-size: 2rem;
      margin: 10px;
      text-align: center;
    }

    .game-box {
      position: relative;
      width: 100vw;
      height: 100vh;
      background: linear-gradient(to top, #999, #ddd);
      overflow: hidden;
      perspective: 1000px;
    }

    .shooter {
      width: 50px;
      height: 50px;
      background: radial-gradient(#ff6b6b, #c0392b);
      border-radius: 50%;
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      transition: transform 0.1s linear;
    }

    .bullet {
      width: 6px;
      height: 15px;
      background-color: lime;
      position: absolute;
      display: none;
      border-radius: 3px;
    }

    .choice {
      position: absolute;
      padding: 15px 25px;
      font-size: 1.2rem;
      border-radius: 10px;
      background: linear-gradient(#fff, #ddd);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      cursor: pointer;
      transform: translateZ(0);
    }

    .score, .lives, .timer, .feedback {
      position: absolute;
      left: 10px;
      font-size: 1.2rem;
      color: #222;
    }
    .score { top: 10px; }
    .lives { top: 40px; }
    .timer { top: 70px; }
    .feedback {
      bottom: 10px;
      font-size: 1.5rem;
      color: red;
    }

    .game-over {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 2rem;
      color: red;
    }
  </style>
</head>
<body>
  <h1>ðŸŽ¯ 3D Algebra Shooter</h1>
  <div class="game-box" id="gameBox">
    <div class="shooter" id="shooter"></div>
    <div class="bullet" id="bullet"></div>

    <div class="score">Score: <span id="score">0</span></div>
    <div class="lives">Lives: <span id="lives">3</span></div>
    <div class="timer">Time: <span id="time">30</span>s</div>
    <div class="feedback" id="feedback"></div>
    <div class="game-over" id="gameOver"></div>
  </div>

  <script>
    const gameBox = document.getElementById('gameBox');
    const shooter = document.getElementById('shooter');
    const bullet = document.getElementById('bullet');
    const scoreDisplay = document.getElementById('score');
    const livesDisplay = document.getElementById('lives');
    const timeDisplay = document.getElementById('time');
    const gameOverText = document.getElementById('gameOver');
    const feedback = document.getElementById('feedback');

    let score = 0;
    let lives = 3;
    let timeLeft = 30;
    let correctAnswer = 0;
    let answerElements = [];
    let timer;

    let keys = {};
    let gameInterval;

    document.addEventListener('keydown', e => keys[e.key] = true);
    document.addEventListener('keyup', e => keys[e.key] = false);

    function getRandomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function generateProblem() {
      let a = getRandomInt(1, 10);
      let b = getRandomInt(1, 10);
      correctAnswer = a;
      return `x + ${b} = ${a + b}`;
    }

    function renderQuestion() {
      answerElements.forEach(el => el.remove());
      answerElements = [];

      const question = generateProblem();
      const answers = [correctAnswer];
      while (answers.length < 4) {
        let fake = correctAnswer + getRandomInt(-5, 5);
        if (!answers.includes(fake)) answers.push(fake);
      }

      answers.sort(() => Math.random() - 0.5);

      answers.forEach((ans, i) => {
        const el = document.createElement('div');
        el.className = 'choice';
        el.textContent = ans;
        el.dataset.answer = ans;
        el.style.left = `${100 + i * 200}px`;
        el.style.top = '150px';
        gameBox.appendChild(el);
        answerElements.push(el);
      });
    }

    function shootBullet() {
      bullet.style.display = 'block';
      bullet.style.left = `${shooter.offsetLeft + 22}px`;
      bullet.style.top = `${shooter.offsetTop}px`;

      const interval = setInterval(() => {
        bullet.style.top = `${bullet.offsetTop - 10}px`;
        if (bullet.offsetTop < 0) {
          clearInterval(interval);
          bullet.style.display = 'none';
        }

        answerElements.forEach(el => {
          const br = bullet.getBoundingClientRect();
          const ar = el.getBoundingClientRect();

          if (br.top <= ar.bottom && br.bottom >= ar.top && br.left >= ar.left && br.right <= ar.right) {
            clearInterval(interval);
            bullet.style.display = 'none';
            if (parseInt(el.dataset.answer) === correctAnswer) {
              score++;
              feedback.textContent = 'âœ” Correct!';
            } else {
              lives--;
              feedback.textContent = 'âœ– Incorrect!';
            }
            updateStatus();
            if (lives <= 0) endGame();
            else renderQuestion();
          }
        });
      }, 20);
    }

    function updateStatus() {
      scoreDisplay.textContent = score;
      livesDisplay.textContent = lives;
    }

    function moveShooter() {
      const moveSpeed = 5;
      let pos = shooter.offsetLeft;
      if (keys['ArrowLeft']) pos -= moveSpeed;
      if (keys['ArrowRight']) pos += moveSpeed;
      pos = Math.max(0, Math.min(pos, gameBox.offsetWidth - shooter.offsetWidth));
      shooter.style.left = `${pos}px`;
    }

    function startGame() {
      score = 0;
      lives = 3;
      timeLeft = 30;
      updateStatus();
      feedback.textContent = '';
      gameOverText.textContent = '';
      renderQuestion();

      clearInterval(timer);
      timer = setInterval(() => {
        timeLeft--;
        timeDisplay.textContent = timeLeft;
        if (timeLeft <= 0) endGame();
      }, 1000);

      gameInterval = setInterval(() => moveShooter(), 20);
    }

    function endGame() {
      clearInterval(timer);
      clearInterval(gameInterval);
      feedback.textContent = '';
      gameOverText.textContent = `ðŸ’€ Game Over! Final Score: ${score}`;
    }

    document.addEventListener('keydown', e => {
      if (e.key === ' ' || e.key === 'Enter') shootBullet();
    });

    startGame();
  </script>
</body>
</html>
